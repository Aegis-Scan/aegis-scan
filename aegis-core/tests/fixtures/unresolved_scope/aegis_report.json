{
  "aegis_version": "0.1.0",
  "deterministic": {
    "capabilities": {
      "env": {
        "read": [
          "OUTPUT_DIR"
        ]
      },
      "fs": {
        "write": [
          "*"
        ]
      },
      "network": {
        "connect": [
          "*"
        ]
      }
    },
    "combination_risks": [],
    "external_binaries": [],
    "file_count": 1,
    "manifest_source": "directory",
    "merkle_tree": {
      "algorithm": "sha256",
      "leaves": [
        {
          "hash": "sha256:865dcc017f6f70a8e8ce5eb01da1349ac471092101127eceeb1593d8c4761077",
          "path": "dynamic.py"
        }
      ],
      "nodes": [],
      "root": "sha256:865dcc017f6f70a8e8ce5eb01da1349ac471092101127eceeb1593d8c4761077"
    },
    "meta_insights": [
      {
        "category": "purpose",
        "detail": "There is no SKILL.md or README.md in the package. Without documentation, there's no way to verify whether the skill's code matches its intended purpose. A skill that doesn't describe itself is asking you to trust it blindly.",
        "evidence": [
          "No SKILL.md, skill.md, README.md, or readme.md found"
        ],
        "severity": "warning",
        "summary": "No SKILL.md or README.md found — the skill doesn't describe itself.",
        "title": "PURPOSE & CAPABILITY"
      },
      {
        "category": "scope",
        "detail": "Without a SKILL.md, there are no instructions to cross-reference.",
        "evidence": [
          "No SKILL.md found"
        ],
        "severity": "info",
        "summary": "No SKILL.md to analyze for instruction scope.",
        "title": "INSTRUCTION SCOPE"
      },
      {
        "category": "install",
        "detail": "There's no setup.py, pyproject.toml, or package manager config, but the package contains 1 Python script(s) and 0 shell script(s). Because there's no controlled install process, using this skill means executing these scripts directly with your environment's Python or shell.\n\nReview the script contents before running them — without a formal install process, there are no dependency declarations to verify and no sandboxing guarantees.",
        "evidence": [
          "Python scripts: 1",
          "Shell scripts: 0"
        ],
        "severity": "info",
        "summary": "No formal install spec, but the package includes 1 executable script(s).",
        "title": "INSTALL MECHANISM"
      },
      {
        "category": "tools",
        "detail": "The skill doesn't declare external tool requirements, and the code doesn't invoke subprocess binaries. Nothing to compare.",
        "evidence": [
          "No declared or detected binaries"
        ],
        "severity": "info",
        "summary": "No tool declarations to verify; code doesn't invoke external binaries.",
        "title": "TOOL DECLARATIONS"
      }
    ],
    "path_violations": [],
    "persona": {
      "confidence": "high",
      "persona": "lgtm",
      "reasoning": "Risk score 37/100. Clean code, clear intent, well-defined scopes. Ship it.",
      "suspicion": "LOW"
    },
    "prohibited_findings": [],
    "remediation_feedback": {
      "constraints": [
        "Prefer local, minimal code edits.",
        "Do not introduce new capabilities.",
        "If uncertain, fail closed and request human review."
      ],
      "max_iterations": 1,
      "mode": "one_pass",
      "objective": "Apply the highest-priority deterministic fixes while preserving behavior.",
      "schema_version": "1.0",
      "tasks": [
        {
          "col": 0,
          "cwe_ids": [
            "CWE-918"
          ],
          "end_col": 15,
          "end_line": 4,
          "file": "dynamic.py",
          "kind": "finding",
          "line": 4,
          "message": "Imports 'requests' — enables network:connect capabilities. Actual risk depends on usage.",
          "owasp_ids": [
            "A10:2021"
          ],
          "pattern": "import requests",
          "risk_note": "The import itself grants access to network operations. Check if the module's dangerous APIs are actually called.",
          "severity": "restricted",
          "suggested_fix": "Pin URLs to known-good endpoints. Ensure SSL verification is enabled (default).",
          "tags": [
            "ssrf",
            "network",
            "import"
          ]
        },
        {
          "col": 9,
          "cwe_ids": [
            "CWE-22",
            "CWE-73"
          ],
          "end_col": 24,
          "end_line": 16,
          "file": "dynamic.py",
          "kind": "finding",
          "line": 16,
          "message": "Filesystem write (target unresolved)",
          "owasp_ids": [
            "A01:2021"
          ],
          "pattern": "open",
          "risk_note": "File path is dynamic — Aegis cannot verify which files are accessed. Could target credentials, configs, or system files.",
          "severity": "restricted",
          "suggested_fix": "Use the minimum required file permissions. Prefer project-local or temp directories. Validate file paths against an allowlist.",
          "tags": [
            "filesystem",
            "arbitrary-write",
            "file-io"
          ]
        },
        {
          "col": 15,
          "cwe_ids": [
            "CWE-918"
          ],
          "end_col": 32,
          "end_line": 23,
          "file": "dynamic.py",
          "kind": "finding",
          "line": 23,
          "message": "Outbound HTTP GET — reads data from external endpoint (target unresolved)",
          "owasp_ids": [
            "A10:2021"
          ],
          "pattern": "requests.get",
          "risk_note": "URL/host is dynamic — Aegis cannot verify the target endpoint. Could connect to attacker-controlled servers (SSRF).",
          "severity": "restricted",
          "suggested_fix": "Ensure `verify=True` (the default) for SSL certificate verification. Pin URLs to known-good endpoints.",
          "tags": [
            "ssrf",
            "network"
          ]
        },
        {
          "col": 11,
          "cwe_ids": [
            "CWE-200"
          ],
          "end_col": 47,
          "end_line": 29,
          "file": "dynamic.py",
          "kind": "finding",
          "line": 29,
          "message": "Environment variable read 'OUTPUT_DIR'",
          "owasp_ids": [
            "A02:2021"
          ],
          "pattern": "os.environ.get",
          "risk_note": "Reads: OUTPUT_DIR. Verify this env var is documented and expected.",
          "severity": "restricted",
          "suggested_fix": "",
          "tags": [
            "info-exposure",
            "env-read"
          ]
        },
        {
          "col": 16,
          "cwe_ids": [
            "CWE-22"
          ],
          "end_col": 48,
          "end_line": 30,
          "file": "dynamic.py",
          "kind": "finding",
          "line": 30,
          "message": "User-controlled input reaches filesystem path operation (os.path.join).",
          "owasp_ids": [
            "A01:2021"
          ],
          "pattern": "taint:os.path.join",
          "risk_note": "A user-controlled path can access or modify unintended files. Use canonicalization and enforce a fixed base-directory allowlist.",
          "severity": "restricted",
          "suggested_fix": "",
          "tags": [
            "filesystem",
            "path-traversal",
            "taint-flow",
            "source-to-sink"
          ]
        },
        {
          "col": 9,
          "cwe_ids": [
            "CWE-22",
            "CWE-73"
          ],
          "end_col": 29,
          "end_line": 31,
          "file": "dynamic.py",
          "kind": "finding",
          "line": 31,
          "message": "Filesystem write (target unresolved)",
          "owasp_ids": [
            "A01:2021"
          ],
          "pattern": "open",
          "risk_note": "File path is dynamic — Aegis cannot verify which files are accessed. Could target credentials, configs, or system files.",
          "severity": "restricted",
          "suggested_fix": "Use the minimum required file permissions. Prefer project-local or temp directories. Validate file paths against an allowlist.",
          "tags": [
            "filesystem",
            "arbitrary-write",
            "file-io"
          ]
        },
        {
          "col": 9,
          "cwe_ids": [
            "CWE-22",
            "CWE-73"
          ],
          "end_col": 29,
          "end_line": 31,
          "file": "dynamic.py",
          "kind": "finding",
          "line": 31,
          "message": "User-controlled input reaches filesystem path operation (open).",
          "owasp_ids": [
            "A01:2021"
          ],
          "pattern": "taint:open",
          "risk_note": "A user-controlled path can access or modify unintended files. Use canonicalization and enforce a fixed base-directory allowlist.",
          "severity": "restricted",
          "suggested_fix": "Use the minimum required file permissions. Prefer project-local or temp directories. Validate file paths against an allowlist.",
          "tags": [
            "filesystem",
            "arbitrary-write",
            "taint-flow",
            "source-to-sink",
            "path-traversal"
          ]
        }
      ]
    },
    "restricted_findings": [
      {
        "capability": {
          "action": "connect",
          "category": "network",
          "scope": [
            "*"
          ],
          "scope_resolved": false
        },
        "col": 0,
        "confidence": "medium",
        "cwe_ids": [
          "CWE-918"
        ],
        "end_col": 15,
        "end_line": 4,
        "file": "dynamic.py",
        "function_context": "",
        "line": 4,
        "message": "Imports 'requests' — enables network:connect capabilities. Actual risk depends on usage.",
        "owasp_ids": [
          "A10:2021"
        ],
        "pattern": "import requests",
        "risk_note": "The import itself grants access to network operations. Check if the module's dangerous APIs are actually called.",
        "severity": "restricted",
        "source_line": "import requests",
        "suggested_fix": "Pin URLs to known-good endpoints. Ensure SSL verification is enabled (default).",
        "tags": [
          "ssrf",
          "network",
          "import"
        ]
      },
      {
        "capability": {
          "action": "write",
          "category": "fs",
          "scope": [
            "*"
          ],
          "scope_resolved": false
        },
        "col": 9,
        "confidence": "high",
        "cwe_ids": [
          "CWE-22",
          "CWE-73"
        ],
        "end_col": 24,
        "end_line": 16,
        "file": "dynamic.py",
        "function_context": "write_results()",
        "line": 16,
        "message": "Filesystem write (target unresolved)",
        "owasp_ids": [
          "A01:2021"
        ],
        "pattern": "open",
        "risk_note": "File path is dynamic — Aegis cannot verify which files are accessed. Could target credentials, configs, or system files.",
        "severity": "restricted",
        "source_line": "    with open(path, \"w\") as f:",
        "suggested_fix": "Use the minimum required file permissions. Prefer project-local or temp directories. Validate file paths against an allowlist.",
        "tags": [
          "filesystem",
          "arbitrary-write",
          "file-io"
        ]
      },
      {
        "capability": {
          "action": "connect",
          "category": "network",
          "scope": [
            "*"
          ],
          "scope_resolved": false
        },
        "col": 15,
        "confidence": "high",
        "cwe_ids": [
          "CWE-918"
        ],
        "end_col": 32,
        "end_line": 23,
        "file": "dynamic.py",
        "function_context": "fetch_data()",
        "line": 23,
        "message": "Outbound HTTP GET — reads data from external endpoint (target unresolved)",
        "owasp_ids": [
          "A10:2021"
        ],
        "pattern": "requests.get",
        "risk_note": "URL/host is dynamic — Aegis cannot verify the target endpoint. Could connect to attacker-controlled servers (SSRF).",
        "severity": "restricted",
        "source_line": "    response = requests.get(url)",
        "suggested_fix": "Ensure `verify=True` (the default) for SSL certificate verification. Pin URLs to known-good endpoints.",
        "tags": [
          "ssrf",
          "network"
        ]
      },
      {
        "capability": {
          "action": "read",
          "category": "env",
          "scope": [
            "OUTPUT_DIR"
          ],
          "scope_resolved": true
        },
        "col": 11,
        "confidence": "high",
        "cwe_ids": [
          "CWE-200"
        ],
        "end_col": 47,
        "end_line": 29,
        "file": "dynamic.py",
        "function_context": "computed_path()",
        "line": 29,
        "message": "Environment variable read 'OUTPUT_DIR'",
        "owasp_ids": [
          "A02:2021"
        ],
        "pattern": "os.environ.get",
        "risk_note": "Reads: OUTPUT_DIR. Verify this env var is documented and expected.",
        "severity": "restricted",
        "source_line": "    base = os.environ.get(\"OUTPUT_DIR\", \"/tmp\")",
        "suggested_fix": null,
        "tags": [
          "info-exposure",
          "env-read"
        ]
      },
      {
        "capability": {
          "action": "read",
          "category": "fs",
          "scope": [
            "*"
          ],
          "scope_resolved": false
        },
        "col": 16,
        "confidence": "high",
        "cwe_ids": [
          "CWE-22"
        ],
        "end_col": 48,
        "end_line": 30,
        "file": "dynamic.py",
        "function_context": "computed_path()",
        "line": 30,
        "message": "User-controlled input reaches filesystem path operation (os.path.join).",
        "owasp_ids": [
          "A01:2021"
        ],
        "pattern": "taint:os.path.join",
        "risk_note": "A user-controlled path can access or modify unintended files. Use canonicalization and enforce a fixed base-directory allowlist.",
        "severity": "restricted",
        "source_line": "    full_path = os.path.join(base, \"output.txt\")",
        "suggested_fix": null,
        "tags": [
          "filesystem",
          "path-traversal",
          "taint-flow",
          "source-to-sink"
        ]
      },
      {
        "capability": {
          "action": "write",
          "category": "fs",
          "scope": [
            "*"
          ],
          "scope_resolved": false
        },
        "col": 9,
        "confidence": "high",
        "cwe_ids": [
          "CWE-22",
          "CWE-73"
        ],
        "end_col": 29,
        "end_line": 31,
        "file": "dynamic.py",
        "function_context": "computed_path()",
        "line": 31,
        "message": "User-controlled input reaches filesystem path operation (open).",
        "owasp_ids": [
          "A01:2021"
        ],
        "pattern": "taint:open",
        "risk_note": "A user-controlled path can access or modify unintended files. Use canonicalization and enforce a fixed base-directory allowlist.",
        "severity": "restricted",
        "source_line": "    with open(full_path, \"w\") as f:",
        "suggested_fix": "Use the minimum required file permissions. Prefer project-local or temp directories. Validate file paths against an allowlist.",
        "tags": [
          "filesystem",
          "arbitrary-write",
          "taint-flow",
          "source-to-sink",
          "path-traversal"
        ]
      },
      {
        "capability": {
          "action": "write",
          "category": "fs",
          "scope": [
            "*"
          ],
          "scope_resolved": false
        },
        "col": 9,
        "confidence": "high",
        "cwe_ids": [
          "CWE-22",
          "CWE-73"
        ],
        "end_col": 29,
        "end_line": 31,
        "file": "dynamic.py",
        "function_context": "computed_path()",
        "line": 31,
        "message": "Filesystem write (target unresolved)",
        "owasp_ids": [
          "A01:2021"
        ],
        "pattern": "open",
        "risk_note": "File path is dynamic — Aegis cannot verify which files are accessed. Could target credentials, configs, or system files.",
        "severity": "restricted",
        "source_line": "    with open(full_path, \"w\") as f:",
        "suggested_fix": "Use the minimum required file permissions. Prefer project-local or temp directories. Validate file paths against an allowlist.",
        "tags": [
          "filesystem",
          "arbitrary-write",
          "file-io"
        ]
      }
    ],
    "risk_score_static": 37
  },
  "ephemeral": {
    "llm_analysis": null,
    "llm_provider": null,
    "llm_risk_adjustment": 0,
    "risk_score_final": 37,
    "taxonomy": {
      "classification_confidence": "none",
      "permission_overreach": [
        "This General Purpose skill requests fs. Unusual for this type — worth double-checking.",
        "This General Purpose skill requests network. Unusual for this type — worth double-checking."
      ],
      "skill_category": "general",
      "tool_overreach": []
    },
    "unresolved_scope_analysis": []
  },
  "scan_target": "C:\\Users\\mhube\\.aegis-audit-MASTER\\aegis-core\\tests\\fixtures\\unresolved_scope",
  "scan_timestamp": "2026-02-12T20:37:42.129738+00:00"
}
